# A2A Protocol Integration for Wireshark MCP

This document explains the integration of Google's Agent-to-Agent (A2A) protocol into the Wireshark MCP tool. The goal is to provide a unified interface for analyzing both MCP (Model Context Protocol) from Anthropic and A2A (Agent-to-Agent) protocol from Google.

## Table of Contents

1. [Overview](#overview)
2. [A2A Protocol](#a2a-protocol)
3. [Integration Features](#integration-features)
4. [UI Changes](#ui-changes)
5. [API Integration](#api-integration)
6. [Packet Inspection](#packet-inspection)
7. [Comparison with MCP](#comparison-with-mcp)
8. [Usage Examples](#usage-examples)

## Overview

The Wireshark MCP tool now supports both Anthropic's Model Context Protocol (MCP) and Google's Agent-to-Agent (A2A) protocol. This dual support enables comprehensive analysis of AI agent communications regardless of the underlying protocol.

These protocols serve complementary purposes:
- **MCP (Model Context Protocol)**: Focuses on providing tools and context to large language models
- **A2A (Agent-to-Agent Protocol)**: Focuses on enabling communication between different AI agents

## A2A Protocol

The Agent-to-Agent (A2A) protocol is an open protocol developed by Google to enable communication and interoperability between opaque agentic applications. It provides a standardized way for AI agents to communicate with each other, share capabilities, and coordinate tasks.

### Core A2A Concepts

- **Agent Card**: A public metadata file (usually at `/.well-known/agent.json`) describing an agent's capabilities, skills, endpoint URL, and authentication requirements.
- **A2A Server**: An agent exposing an HTTP endpoint that implements the A2A protocol methods. It receives requests and manages task execution.
- **A2A Client**: An application or another agent that consumes A2A services by sending requests.
- **Task**: The central unit of work, with states like `submitted`, `working`, `input-required`, `completed`, `failed`, `canceled`.
- **Message**: Communication turns between client (`role: "user"`) and agent (`role: "agent"`).
- **Part**: Content units within a `Message` or `Artifact` (TextPart, FilePart, DataPart).
- **Artifact**: Outputs generated by the agent during a task execution.

## Integration Features

The Wireshark MCP tool now offers the following A2A-related features:

1. **Protocol Toggle**: Switch between MCP and A2A protocol views
2. **A2A Packet Analysis**: Capture and analyze A2A protocol communications
3. **Task Visualization**: Visualize A2A tasks and their state transitions
4. **Message Inspection**: Examine A2A messages, parts, and artifacts
5. **Protocol Comparison**: Compare differences between MCP and A2A structures
6. **Theme Customization**: Separate theme settings for MCP and A2A interfaces

## UI Changes

The following UI elements have been added to support A2A:

1. **Protocol Toggle**: A toggle switch in the main toolbar to switch between MCP and A2A views
2. **Protocol Indicator**: A badge/indicator showing the current active protocol
3. **A2A Dashboard**: A specialized view for A2A task monitoring
4. **A2A Packet List**: A filterable list of A2A protocol packets
5. **Task Flow Visualization**: A graphical representation of A2A task state transitions
6. **Message Explorer**: A specialized view for exploring A2A message structures

## API Integration

The tool now includes integration with the A2A protocol specification:

1. **Agent Card Discovery**: Ability to discover and parse A2A agent cards
2. **Task Management**: Support for A2A task lifecycle operations
3. **Streaming Support**: Handling for A2A streaming responses (SSE)
4. **Push Notifications**: Support for A2A push notification subscriptions
5. **Authentication**: Support for A2A authentication schemes

## Packet Inspection

### A2A Packet Structure

A2A packets are displayed with the following details:

- **Task ID**: Unique identifier for the A2A task
- **Method**: A2A method being invoked (e.g., `tasks/send`, `tasks/get`)
- **State**: Current state of the task
- **Message Parts**: Content of messages exchanged
- **Artifacts**: Any artifacts generated during task execution
- **Timestamps**: Timing information for the packet

### A2A Visualization

The network visualization now includes:

- **Color Coding**: Different colors for A2A vs MCP nodes
- **State Indicators**: Visual indicators for task states
- **Flow Visualization**: Directed graphs showing task progression
- **Task Grouping**: Ability to group related A2A packets by task ID

## Comparison with MCP

| Feature | MCP | A2A |
|---------|-----|-----|
| **Primary Purpose** | Providing tools and context to LLMs | Enabling agent-to-agent communication |
| **Core Unit** | Context window with tools | Tasks with messages |
| **Communication** | Unidirectional (to model) | Bidirectional (between agents) |
| **State Management** | Stateless | Stateful (task lifecycle) |
| **Data Structure** | XML-based | JSON-based |
| **Authentication** | Not specified | Multiple schemes supported |
| **Streaming** | Not specified | Supported via SSE |
| **Error Handling** | Basic | JSON-RPC error objects |
| **Discovery** | Not specified | Agent Card discovery |

## Usage Examples

### Capturing A2A Traffic

1. Start the Wireshark MCP tool
2. Switch to A2A protocol mode using the toggle
3. Upload a PCAP file containing A2A traffic
4. The tool will automatically identify and parse A2A packets

### Analyzing A2A Tasks

1. Select an A2A packet from the packet list
2. The tool will show all related packets in the same task
3. The task flow visualization will show state transitions
4. The message explorer will display task message details

### Comparing Protocols

1. Capture both MCP and A2A traffic
2. Use the protocol toggle to switch between views
3. The visualization will highlight differences in communication patterns
4. Use the comparison view to see structural differences

## Conclusion

The integration of A2A protocol support alongside MCP makes the Wireshark MCP tool a comprehensive solution for analyzing AI agent communications. Whether you're working with Anthropic's Claude or Google's agent frameworks, this tool provides the insights needed to understand and debug AI communications.
